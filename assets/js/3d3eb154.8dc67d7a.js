"use strict";(self.webpackChunkmarkdown_website=self.webpackChunkmarkdown_website||[]).push([[950],{28453:(e,r,i)=>{i.d(r,{R:()=>n,x:()=>l});var a=i(96540);const t={},c=a.createContext(t);function n(e){const r=a.useContext(c);return a.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:n(e.components),a.createElement(c.Provider,{value:r},e.children)}},71638:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>n,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"clients/puignau/certificat SQL Server","title":"Certificat SQL Server","description":"Problema","source":"@site/docs/clients/puignau/certificat SQL Server.md","sourceDirName":"clients/puignau","slug":"/clients/puignau/certificat SQL Server","permalink":"/nowtech-docs/docs/clients/puignau/certificat SQL Server","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"clientsSidebar","previous":{"title":"PBI Botigues","permalink":"/nowtech-docs/docs/clients/puignau/PBI/PBI Botigues/"},"next":{"title":"Query Print Albara","permalink":"/nowtech-docs/docs/clients/puignau/imp_alb/"}}');var t=i(74848),c=i(28453);const n={},l="Certificat SQL Server",s={},o=[{value:"Problema",id:"problema",level:2},{value:"Solucio",id:"solucio",level:2},{value:"Crear certificat",id:"crear-certificat",level:3},{value:"Aplicar permisos al certificat",id:"aplicar-permisos-al-certificat",level:3},{value:"Aplicar certificat a SQL Server",id:"aplicar-certificat-a-sql-server",level:3},{value:"Problema en reiniciar",id:"problema-en-reiniciar",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"certificat-sql-server",children:"Certificat SQL Server"})}),"\n",(0,t.jsx)(r.h2,{id:"problema",children:"Problema"}),"\n",(0,t.jsxs)(r.p,{children:["Degut a que els nous clients SQL Server utilitzen un parametre que es diu Encrypt, fa que es requereixi activar sempre una opcio que es diu ",(0,t.jsx)(r.code,{children:"TrustServerCertificate"}),"."]}),"\n",(0,t.jsx)(r.h2,{id:"solucio",children:"Solucio"}),"\n",(0,t.jsx)(r.h3,{id:"crear-certificat",children:"Crear certificat"}),"\n",(0,t.jsxs)(r.p,{children:["Degut d'aixo s'ha optat per fer un certificat autofirmat per el Servidor ",(0,t.jsx)(r.code,{children:"192.168.0.4"})," amb la comanda powershell:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-powershell",children:'New-SelfSignedCertificate `\r\n  -CertStoreLocation "cert:\\LocalMachine\\My" `\r\n  -Subject "CN=192.168.0.4" `\r\n  -FriendlyName "Certificat SQL Server" `\r\n  -KeySpec KeyExchange `\r\n  -KeyExportPolicy Exportable `\r\n  -TextExtension @("2.5.29.37={text}1.3.6.1.5.5.7.3.1") `\r\n  -NotAfter (Get-Date).AddYears(5)\n'})}),"\n",(0,t.jsx)(r.h3,{id:"aplicar-permisos-al-certificat",children:"Aplicar permisos al certificat"}),"\n",(0,t.jsxs)(r.p,{children:["Un cop amb el certificat, hem entrat al gestort de certificats, l'hem buscat dintre dels certificats de l'equip local i a la carpeta ",(0,t.jsx)(r.code,{children:"personal"})," -> ",(0,t.jsx)(r.code,{children:"Certificats"}),", n'hi ha un que es diu ",(0,t.jsx)(r.code,{children:"Certificat SQL Server"}),". Ara li farem clic dret -> ",(0,t.jsx)(r.code,{children:"Todas las tareas"})," -> ",(0,t.jsx)(r.code,{children:"Administrar claus privades"}),". Aqui li donarem a afegir, i buscarem l'usuari que utilitza l'SQL Server, normalment amagat (",(0,t.jsx)(r.code,{children:"MSSQL$"}),"...)."]}),"\n",(0,t.jsx)(r.h3,{id:"aplicar-certificat-a-sql-server",children:"Aplicar certificat a SQL Server"}),"\n",(0,t.jsx)(r.p,{children:"Ara entrarem a la consola de configuracio de SQL Server i buscarem el protocol per la nostra instancia, un cop alla farem clic dret a la opcio i propiedades.\r\nVeurem que hi ha una pestanya de certificat, en entrar trobarem un desplegable el qual trobarem el nostre certificat nou alla. Un cop marcat, ens avisara que hem de reiniciar el servei. Si tot es correcte el servei es reiniciara correctament."}),"\n",(0,t.jsx)(r.h2,{id:"problema-en-reiniciar",children:"Problema en reiniciar"}),"\n",(0,t.jsx)(r.p,{children:"En cas de no arrencar podria ser que l'usuari que arranca l'SQL Server no sigui el que hem donat permisos i li faltin permisos per utilitzar el certificat."})]})}function u(e={}){const{wrapper:r}={...(0,c.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);