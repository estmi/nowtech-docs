"use strict";(self.webpackChunkmarkdown_website=self.webpackChunkmarkdown_website||[]).push([[6940],{28453:(e,r,n)=>{n.d(r,{R:()=>c,x:()=>s});var t=n(96540);const i={},o=t.createContext(i);function c(e){const r=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(o.Provider,{value:r},e.children)}},86169:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>s,default:()=>p,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"puignau/CRM/updateCRMprices","title":"Update preus en calent de l\'historic de CRM","description":"Articles tots","source":"@site/docs/puignau/CRM/updateCRMprices.md","sourceDirName":"puignau/CRM","slug":"/puignau/CRM/updateCRMprices","permalink":"/nowtech-docs/docs/puignau/CRM/updateCRMprices","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"puignauSidebar","previous":{"title":"tr_Pers_PrePedido_Lineas_AfterInsert","permalink":"/nowtech-docs/docs/puignau/CRM/tr_Pers_PrePedido_Lineas_AfterInsert"},"next":{"title":"Vista televendes","permalink":"/nowtech-docs/docs/puignau/CRM/view_televendes/"}}');var i=n(74848),o=n(28453);const c={},s="Update preus en calent de l'historic de CRM",a={},d=[{value:"Articles tots",id:"articles-tots",level:2},{value:"Bundles",id:"bundles",level:2}];function l(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"update-preus-en-calent-de-lhistoric-de-crm",children:"Update preus en calent de l'historic de CRM"})}),"\n",(0,i.jsx)(r.h2,{id:"articles-tots",children:"Articles tots"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sql",children:"update pph\r\nset pph.precioUnidad = precioart.precio\r\n\r\nfrom Pers_PrePedido_Calculo_Historico pph\r\n\r\nOUTER APPLY \r\n(\r\n    SELECT Precio\r\n    FROM dbo.fPers_DamePrecio_Articulo_Delegacion_v2\r\n    (\r\n        pph.IdArticulo, pph.IdCliente, NULL, GETDATE(), NULL, NULL,\r\n            (select top 1 iddelegacion from Clientes_Datos where IdCliente = pph.IdCliente)\r\n    )\r\n) AS PrecioArt\n"})}),"\n",(0,i.jsx)(r.h2,{id:"bundles",children:"Bundles"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sql",children:"update pph\r\nset pph.idarticulohijo = ac.IdArticulo,pph.IdArticuloFeina = acFeina.IdArticulo, pph.PrecioFeina=PrecioFeina.Precio , \r\npph.PrecioUnidad = PrecioArt.Precio\r\n\r\nfrom Pers_PrePedido_Calculo_Historico pph\r\ninner join Articulos_Conjuntos ac ON ac.IdArticuloPadre = pph.IdArticulo \r\n    and ac.IdArticulo not in (select Article from vPers_Articles where Familia = 'Z-TX')\r\ninner join Articulos_Conjuntos acFeina ON acFeina.IdArticuloPadre = pph.IdArticulo \r\n    and acFeina.IdArticulo  in (select Article from vPers_Articles where Familia = 'Z-TX')\r\nOUTER APPLY \r\n(\r\n    SELECT Precio\r\n    FROM dbo.fPers_DamePrecio_Articulo_Delegacion_v2\r\n    (\r\n        acFeina.IdArticulo, pph.IdCliente, NULL, GETDATE(), NULL, NULL,\r\n            (select top 1 iddelegacion from Clientes_Datos where IdCliente = pph.IdCliente)\r\n    )\r\n) AS PrecioFeina\r\nOUTER APPLY \r\n(\r\n    SELECT Precio\r\n    FROM dbo.fPers_DamePrecio_Articulo_Delegacion_v2\r\n    (\r\n        ac.IdArticulo, pph.IdCliente, NULL, GETDATE(), NULL, NULL,\r\n            (select top 1 iddelegacion from Clientes_Datos where IdCliente = pph.IdCliente)\r\n    )\r\n) AS PrecioArt\n"})})]})}function p(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);